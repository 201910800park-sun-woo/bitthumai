이 시스템은 비트코인 자동 트레이딩을 위해 AI를 활용하며, 다음 4단계에 걸쳐 작동합니다.

1. 데이터 수집 📊
먼저, AI의 판단에 필요한 다양한 데이터를 수집합니다.

차트 데이터: 단기(1시간), 중기(4시간), 장기(일봉) 등 여러 시간대의 비트코인 차트 데이터를 빗썸 API에서 가져와 시장의 기술적 추세를 분석합니다.

뉴스 데이터: SerpAPI를 통해 최신 비트코인 관련 뉴스 기사를 수집하여 시장의 전반적인 분위기와 심리적 요인을 파악합니다.

잔고 및 거래 내역: 현재 보유하고 있는 원화(KRW)와 비트코인(BTC) 잔고, 그리고 SQLite 데이터베이스에 저장된 과거 5개 거래의 이력을 불러옵니다. 이 내역은 AI가 자신의 과거 결정을 되돌아보고 학습하는 데 사용됩니다.

2. AI의 판단 🧠
수집된 모든 데이터를 하나의 JSON 객체로 묶어 OpenAI의 GPT-4o 모델로 전송합니다.

AI는 system 역할 지시를 통해 "절대 돈을 잃지 않는다"는 원칙을 따르는 투자 전문가 역할을 부여받습니다.

AI는 차트의 기술적 지표, 뉴스의 긍정/부정적 심리, 그리고 과거 거래의 성공 여부를 종합적으로 분석합니다.

이후, 매수(buy), 매도(sell), 또는 보유(hold) 중 하나의 결정을 내리고, 매수/매도 시에는 사용할 자금의 비율(percentage, 1~100)을 함께 결정합니다. 모든 판단에는 그 이유가 담긴 **reason**이 포함됩니다.

3. 거래 실행 🚀
AI의 판단에 따라 실제 빗썸 거래소에서 시장가 주문을 실행합니다.

매수 시: AI가 결정한 비율만큼의 원화 잔고를 사용해 비트코인을 매수합니다.

매도 시: AI가 결정한 비율만큼의 비트코인 잔고를 사용해 매도합니다.

보유 시: 아무런 거래도 하지 않고 현재 포지션을 유지합니다.

모든 거래는 최소 주문 금액인 5,000 KRW 이상일 때만 실행됩니다.

4. 기록 및 스케줄링 📝
거래가 완료된 후, AI의 결정과 그 시점의 잔고, 가격 등 모든 정보를 SQLite 데이터베이스에 기록합니다.

이 기록은 다음 번 AI가 판단할 때 중요한 학습 자료로 재활용됩니다.

이 시스템은 무한 루프가 아닌, schedule 라이브러리를 통해 매일 09:00, 15:00, 21:00에 정해진 시간에만 실행되도록 자동화되어 있습니다. 이를 통해 불필요한 API 호출을 최소화하고 자원을 효율적으로 관리합니다.


Bitcoin AI Trading Dashboard 코드 분석 📈
이 코드는 Streamlit을 사용하여 이전에 분석했던 AI 자동 트레이딩 봇의 결과를 시각적으로 보여주는 웹 대시보드를 구축합니다. 데이터베이스(bitcoin_trading.db)에 기록된 거래 내역을 불러와 사용자가 투자 성과와 AI의 판단을 한눈에 파악할 수 있도록 돕는 역할을 해요.

1. 데이터 처리 및 로드 💾
load_trade_data() 함수는 SQLite 데이터베이스에 연결하여 trades 테이블의 모든 데이터를 불러옵니다. 이 데이터는 Python의 pandas DataFrame으로 변환됩니다.

DataFrame에 새로운 열을 추가하여 분석에 필요한 지표를 계산합니다.

portfolio_value: 현재 KRW 잔고와 BTC 잔고의 가치를 합산하여 전체 포트폴리오의 총 가치를 계산합니다.

profit_loss 및 profit_loss_pct: 첫 번째 거래 시점의 포트폴리오 가치를 기준으로 절대 수익금과 **수익률(%)**을 계산합니다. 이를 통해 시간 흐름에 따른 투자 성과를 추적할 수 있습니다.

2. 대시보드 핵심 지표 표시 📊
st.title("Bitcoin AI Trading Dashboard"): 대시보드의 제목을 설정합니다.

st.columns(2): 화면을 두 개의 열로 나누어 주요 지표를 깔끔하게 배치합니다.

st.metric: 포트폴리오 가치와 최근 거래 정보를 카드 형태로 표시합니다.

포트폴리오 가치: 현재 총 자산 가치를 보여주며, 수익률(delta)을 함께 표시하여 성과를 직관적으로 나타냅니다.

최근 거래: AI의 가장 최근 결정(BUY/SELL/HOLD)과 투자 비율(percentage)을 보여줍니다.

st.markdown: 현재 비트코인(BTC)과 원화(KRW)의 잔고를 상세히 표시하여 현재 자산 상태를 알 수 있게 합니다.

3. 수익률 및 가격 변화 차트 📈
plotly.graph_objects를 사용하여 인터랙티브한 차트를 생성합니다.

수익률 변화 차트: 시간의 흐름에 따른 **수익률(profit_loss_pct)**을 라인 차트로 보여줍니다.

0%를 나타내는 기준선(회색 점선)을 추가하여 수익과 손실 구간을 쉽게 구분할 수 있어요.

매수(🟢), 매도(🔴), 보유(🟠) 결정 시점에 해당하는 마커를 차트에 표시하여, 어떤 결정이 수익률 변화에 영향을 미쳤는지 시각적으로 파악할 수 있게 합니다.

BTC 가격 변화 차트: 비트코인 가격의 변화를 라인 차트로 보여줍니다.

매수(▲)와 매도(▼) 시점을 삼각형 마커로 표시하여, AI가 어떤 가격대에서 거래를 했는지 명확하게 보여줍니다. 이는 AI의 매매 전략을 평가하는 데 중요한 정보가 됩니다.

4. 상세 거래 내역 및 AI 판단 이유 📝
매매 내역 테이블: 모든 거래의 상세 정보를 pandas DataFrame 형태로 테이블로 보여줍니다. 수익률, 잔고, 결정, 시간 등 주요 정보를 한눈에 확인할 수 있도록 깔끔하게 포맷팅되어 있습니다.

거래 상세 탭 (st.tabs):

"거래 세부사항" 탭: st.selectbox를 사용해 특정 거래를 선택하면, 해당 거래의 결정, 가격, 잔고, 포트폴리오 가치 등 모든 상세 정보를 표시합니다.

"AI 판단 이유" 탭: 선택된 거래에 대해 AI가 왜 그런 결정을 내렸는지(reason 컬럼)를 텍스트로 보여줍니다. 이를 통해 사용자는 AI의 논리를 이해하고 신뢰도를 높일 수 있습니다.
